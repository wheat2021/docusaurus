---
sidebar_position: 10
slug: /api/plugins/@docusaurus/plugin-sitemap
---

# 📦 plugin-sitemap

import APITable from '@site/src/components/APITable';

该插件为你的网站创建站点地图，以便搜索引擎爬虫能更准确地抓取你的网站。

:::warning 仅限生产环境

该插件在开发环境中始终处于非活动状态，**仅在生产环境中激活**，因为它作用于构建输出。

:::

## 安装 {#installation}

```bash npm2yarn
npm install --save @docusaurus/plugin-sitemap
```

:::tip

如果你使用预设 `@docusaurus/preset-classic`，则无需将此插件作为依赖项安装。

你可以通过[预设选项](../../using-plugins.mdx#docusauruspreset-classic)配置此插件。

:::

## 配置 {#configuration}

接受的字段：

```mdx-code-block
<APITable>
```

| 名称 | 类型 | 默认值 | 描述 |
| --- | --- | --- | --- |
| `lastmod` | `'date' \| 'datetime' \| null` | `null` | `date` 是 YYYY-MM-DD。 `datetime` 是 ISO 8601 日期时间。 `null` 表示禁用。参见[站点地图文档](https://www.sitemaps.org/protocol.html#xmlTagDefinitions)。 |
| `changefreq` | `string \| null` | `'weekly'` | 参见[站点地图文档](https://www.sitemaps.org/protocol.html#xmlTagDefinitions) |
| `priority` | `number \| null` | `0.5` | 参见[站点地图文档](https://www.sitemaps.org/protocol.html#xmlTagDefinitions) |
| `ignorePatterns` | `string[]` | `[]` | 一个 glob 模式列表；匹配的路由路径将从站点地图中过滤掉。请注意，你可能需要在此处包含基本 URL。 |
| `filename` | `string` | `sitemap.xml` | 创建的站点地图文件的路径，相对于输出目录。当你有两个插件实例输出两个文件时很有用。 |
| `createSitemapItems` | <code>[CreateSitemapItemsFn](#CreateSitemapItemsFn) \| undefined</code> | `undefined` | 一个可选函数，可用于转换和/或过滤站点地图中的项目。 |

```mdx-code-block
</APITable>
```

### 类型 {#types}

#### `CreateSitemapItemsFn` {#CreateSitemapItemsFn}

```ts
type CreateSitemapItemsFn = (params: {
  siteConfig: DocusaurusConfig;
  routes: RouteConfig[];
  defaultCreateSitemapItems: CreateSitemapItemsFn;
}) => Promise<SitemapItem[]>;
```

:::info

该插件还遵循一些网站配置：

- [`noIndex`](../docusaurus.config.js.mdx#noIndex)：导致不生成站点地图
- [`trailingSlash`](../docusaurus.config.js.mdx#trailingSlash)：决定站点地图中的 URL 是否有尾部斜杠

:::

:::note 关于 `lastmod`

只有当插件提供[路由元数据](../plugin-methods/lifecycle-apis.mdx#addRoute)的 `sourceFilePath` 和/或 `lastUpdatedAt` 属性时，`lastmod` 选项才会输出站点地图的 `<lastmod>` 标签。

所有官方内容插件都为由内容文件（Markdown、MDX 或 React 页面组件）支持的路由提供元数据，但第三方插件作者可能不提供此信息，该插件将无法为他们的路由输出 `<lastmod>` 标签。

:::

### 配置示例 {#ex-config}

你可以通过预设选项或插件选项来配置此插件。

:::tip

大多数 Docusaurus 用户通过预设选项配置此插件。

:::

```js config-tabs
// 预设选项: sitemap
// 插件选项: @docusaurus/plugin-sitemap

const config = {
  lastmod: 'date',
  changefreq: 'weekly',
  priority: 0.5,
  ignorePatterns: ['/tags/**'],
  filename: 'sitemap.xml',
  createSitemapItems: async (params) => {
    const {defaultCreateSitemapItems, ...rest} = params;
    const items = await defaultCreateSitemapItems(rest);
    return items.filter((item) => !item.url.includes('/page/'));
  },
};
```

你可以在 `/sitemap.xml` 找到你的站点地图。
